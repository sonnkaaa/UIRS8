{% extends 'tasks/base.html' %}

{% block content %}
<div class="row">
    <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ ‚Äî –ø—Ä–æ–µ–∫—Ç—ã -->
    <div class="col-md-4">
        <h4>–ú–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã</h4>
        <ul class="list-group mb-3">
            {% for project in projects %}
                <a href="?project={{ project.id }}" class="list-group-item list-group-item-action {% if selected_project and project.id == selected_project.id %}active{% endif %}">
                    {{ project.name }}
                </a>
            {% endfor %}
        </ul>

        <form method="post" class="card p-3 border">
            {% csrf_token %}
            <label for="id_name">–ò–º—è –ø—Ä–æ–µ–∫—Ç–∞</label>
            {{ project_form.name }}
            <button type="submit" class="btn btn-sm btn-success mt-2">+ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</button>
        </form>
        <hr>
        <a href="{% url 'calendar' %}" class="btn btn-outline-primary w-100">üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å</a>
    </div>

    <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ ‚Äî –∑–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞ -->
    <div class="col-md-8">
        {% if selected_project %}
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h4>
    –ó–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞:
    <a href="{% url 'project_detail' selected_project.id %}">
        {{ selected_project.name }}
    </a>
</h4>

                <a href="{% url 'add_task' selected_project.id %}" class="btn btn-primary btn-sm">+ –ó–∞–¥–∞—á–∞</a>
            </div>
            <table class="table table-borderless">
                <thead>
                    <tr>
                        <th>–ó–∞–¥–∞—á–∞</th>
                        <th>–î–µ–¥–ª–∞–π–Ω</th>
                        <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                        <th>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</th>
                        <th></th>  <!-- –ü—É—Å—Ç–æ–π —Å—Ç–æ–ª–±–µ—Ü –¥–ª—è –∫–Ω–æ–ø–∫–∏ -->
                    </tr>
                </thead>
                <tbody>
                    {% for task in tasks %}
                        <tr>
                            <td>
                                {{ task.title }}<br>
                                <a href="{% url 'edit_task' task.id %}" class="btn btn-sm btn-outline-secondary mt-1">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                            </td>
                            <td>{{ task.due_date }}</td>
                            <td>
                                {% if task.description %}
                                    {{ task.description }}
                                {% else %}
                                    <span class="text-muted">‚Äî</span>
                                {% endif %}
                            </td>
                            <td>
                                {% if task.priority == 'low' %}
                                    <span class="text-success">–ù–∏–∑–∫–∏–π</span>
                                {% elif task.priority == 'medium' %}
                                    <span class="text-warning">–°—Ä–µ–¥–Ω–∏–π</span>
                                {% elif task.priority == 'high' %}
                                    <span class="text-danger fw-bold">–í—ã—Å–æ–∫–∏–π</span>
                                {% endif %}
                            </td>
                            <td>
                                <!-- –ò–∫–æ–Ω–∫–∞ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
                                <form method="POST" action="{% url 'complete_task' task.id %}" class="d-inline">
                                    {% csrf_token %}
                                    <button type="submit" class="btn btn-sm btn-success p-0" title="–ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–¥–∞—á—É">
                                        <i class="fas fa-check-circle" style="font-size: 1.5rem; color: #28a745;"></i>
                                    </button>
                                </form>
                            </td>
                        </tr>
                    {% empty %}
                        <tr><td colspan="5">–ó–∞–¥–∞—á –ø–æ–∫–∞ –Ω–µ—Ç</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p class="text-muted">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç —Å–ª–µ–≤–∞, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∑–∞–¥–∞—á–∏.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
